<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>六度盒子项目推荐</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport">
	<meta name="keywords" content="投资大佬,股权,融资,众筹,投资人,投资机构,创业者,合伙人,BP,计划书,项目,对接,路演,风险投资,创业,投资,创投,VC,天使">
    <meta name="description" content="六度盒子是一个投资人社交产品，通过提供平台化工具，依托于用户社交关系，以满足于每个投资人的个性化需求，包括拓展人脉、股权交易、行业交流、项目管理等。">
    <script src="http://cdn.bootcss.com/jquery/1.8.3/jquery.min.js"></script>
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css" >
    <style>
    /*样式重置*/
    body,div,p,input,form,textarea,button{
	    margin: 0;
	    padding: 0;
	    border: none;
	    font-family: "微软雅黑";
	    /*display: block;*/
    }
    input,textarea{
    	 border:1px solid #fff ;
    }
    html,body{
    	width: 100%;
    	height: 100%;
    	overflow: hidden;
    }

    .container{
    	margin-top: 3.8vh; 
    }
   
    .recomButton{
        background: #4F5D8F;;
    	color: #fff;
    	width: 100vw;
    	height: 7.5vh;
    	line-height: 7.5vh;
    	position:absolute;
    	left: 0;
    	right: 0;
    	bottom: 0;
    	text-align: center;
    }
   
    .textstyle{
    	height: 6.4vh;
    }
    </style>
</head>
<body>
<div class="container">
   <div class="">
    <label>项目参与情况</label>
    <div class="radio ">
  <label>
    <input type="radio" name="optionsRadios" id="optionsRadios1"  >
    投过
  </label>
</div>
<div class="radio" style="margin-top:-30px;margin-left: 100px;">
  <label>
    <input type="radio" name="optionsRadios" id="optionsRadios2" >
    约过
  </label>
</div>
  
  </div>
<form role="form">
  
  <div class="form-group">
    <label for="recomWord" style="">推荐语</label>
    <textarea value="请输入推荐语" maxlength="99" id="recomWord" style="height: 28.6vh;" class="form-control" placeholder="请输入推荐语"></textarea>
  </div>
  <div class="form-group">
    <label for="userName">姓名</label>
    <input type="text"  class="form-control textstyle" id="userName" placeholder="请输入您的姓名" >
  </div>
  <div class="form-group">
    <label for="telNum">手机号</label>
    <input type="text" maxlength="11" class="form-control textstyle" id="telNum" placeholder="请输入您的手机号" onkeypress="number()" onkeyup="filterInput();" onchange="filterInput()" onbeforepaste="filterPaste()" onpaste="return false">
  </div>
  <div class="form-group ">
    <label for="checkCode">验证码</label>
    <input type="text" maxlength="4" style="width:60vw;" class="form-control textstyle" id="checkCode" placeholder="请输入验证码" onkeypress="number()" onkeyup="filterInput()" onchange="filterInput()" onbeforepaste="filterPaste()" onpaste="return false">
    <button type="button" id="getCheckCode" style="width:28vw;position:relative;left:62vw;top:-6.4vh;outline:none;" class="btn btn-default textstyle" >获取验证码</button>
    </div>
  
    </form>
   <div  id="warn" style="color:red;width:100vw;position: absolute;left: 0;right: 0;bottom: 8vh;text-align: center;">
   	<!-- <span id="warn" style="color:red;width:100vw;text-align: center;display: inline-block;margin: 0 auto"></span> -->
   </div> 

<div class="recomButton" id="recomand" style="">完成推荐</div>

</div>
<!-- <script> 

alert(window.location.href);
</script> -->
<script language=jscript>
    function number()
    {
        var char = String.fromCharCode(event.keyCode)
        var re = /[0-9]/g
        event.returnValue = char.match(re) != null ? true : false
    }

    function filterInput()
    {
        if (event.type.indexOf("key") != -1)
        {
            var re = /37|38|39|40/g
            if (event.keyCode.toString().match(re)) return false
        }
        event.srcElement.value = event.srcElement.value.replace(/[^0-9]/g, "")
    }

    function filterPaste()
    {
        var oTR = this.document.selection.createRange()
        var text = window.clipboardData.getData("text")
        oTR.text = text.replace(/[^0-9]/g, "")
    }
    (function ($) {
                $.getUrlParam = function (name) {
                    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                    var r = window.location.search.substr(1).match(reg);
                    if (r != null) return unescape(r[2]); return null;
                }
    })(jQuery);

           
            
</script>
<script>
	$(document).ready(function(){
		var newurl = "http://118.178.128.47:8080";
		var getCheckCode=$("#getCheckCode")[0];
		var warn=$("#warn");
		 var test = {
            node:null,
            count:60,
            start:function(){
                //console.log(this.count);
                if(this.count > 0){
                    this.node.innerHTML = "重新发送"+this.count--;
                    var _this = this;
                    setTimeout(function(){
                        _this.start();
                    },1000);
                }else{
                    this.node.removeAttribute("disabled");
                    this.node.innerHTML = "重新发送";
                    this.count = 60;
                }
            },
            //初始化
            init:function(node){
                this.node = node;
                this.node.setAttribute("disabled",true);
                this.start();
            }
        };
		 $("#getCheckCode").click(function(){
            var telNum=$("#telNum").val();
            var myreg = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
            if(!myreg.test(telNum))
            {
                warn.text("请输入有效的手机号码")
            }
            else{
                $.ajax({
                    type: "post",
                    url: newurl + "/user/isnew",
                    async: false, 
                    data: JSON.stringify({
                        "sourceType": 0,
                        "loginName": telNum
                    }),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        console.log(data);
                            test.init(getCheckCode);
                            $.ajax({
                                type: "get",
                                url: newurl + "/user/requestCode",
                                async: false, 
                                data:({
                                    "mobile": telNum
                                }),
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {
                                    console.log(data);
                                    if(data.code==200){
                                        warn.text("短信已发送,请耐心等待...")
                           
                                    }else{
                                    	warn.text("服务器繁忙，请重试！");
                                      
                                    }
                                }})
                        }

                 
                })
            }
        })


            $("#recomand").click(function(){
            	var telNum=$("#telNum").val();
            	var recomWord=$("#recomWord").val();
                var name=$("#userName").val();
            	var checkCode=$("#checkCode").val();
            	var recTag=$("#optionsRadios1").attr("checked")=="checked"?1:2;
            	var projectId = $.getUrlParam('projectId');
            	// alert(projectId);
            	if(telNum==''||recomWord==''||name==''||checkCode==''){
            		warn.text("请将信息填写完整");
            	}else if(($("#optionsRadios1").attr("checked")!="checked")&($("#optionsRadios2").attr("checked")!="checked")){
                    warn.text("请将信息填写完整");
            	}

            	else{
            $.ajax({
                    type: "post",
                    url: newurl + "/operationActivity/recAndRegister",
                    async: false, 
                    data:JSON.stringify({
                        "name": name,
                        "phoneNum": telNum,
                        "msgCode": checkCode,
                        "projectId": "5774f5320cf2a79fcd178244",
                        // "projectId":projectId,   
                        "ProjectRecommendTag": recTag,
                        "recReason": recomWord
                    }),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        console.log(data);
                        //成功类
                        if(data.code==200){
                        	if(data.result.msg=='success'){
                        	warn.text("推荐成功");
                        }else{
                        	warn.text(data.result.msg);
                        }
                        //不成功类
                        }else{
                        	warn.text(data.errorCode.msg);
                        }
                        
                    }
                   })
                    }
	            })

        })
        
</script>
</body>
</html>